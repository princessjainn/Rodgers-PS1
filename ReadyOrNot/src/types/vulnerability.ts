export type Severity = 'ERROR' | 'WARNING' | 'INFO';

export interface Vulnerability {
    id: string;
    title: string;
    severity: Severity;
    file: string; // The relative or absolute path of the affected file
    line: number; // 1-indexed line number where the issue occurred
    description: string;
    recommendation: string;
    agentSource: string; // Name of the scanning agent (e.g., 'SecurityAgent')
}

// Representing a scanned file input format for agents
export interface WorkspaceFile {
    uri: string; // e.g., file path
    fsPath: string; // the physical path
    content: string; // text content of the file
    languageId?: string; // language detection (e.g. 'typescript', 'python')
}

// Represents the final combined health report
export interface FinalAuditReport {
    vulnerabilities: Vulnerability[];
    scoreDetails: {
        totalVulnerabilities: number;
        errorCount: number;
        warningCount: number;
        infoCount: number;
        finalScore: number; // e.g., 0 to 100 where 100 is perfectly secure
        decision: 'GO' | 'NO-GO'; // deployment readiness
    };
    timestamp: string;
}
